<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Billy's zoo of planets</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
</head>
<body>

    <h2>Billy's zoo of planets</h2>
    <div id="plot"></div>
    <p id="output">Click on a planet to see details</p>
    <canvas id="qr-code"></canvas>

    <script>
        // Data embedded at build time by generate_clickablejs.py
        var data = [
    {
        "mass": 110,
        "orbital_separation": 0.6925,
        "label": "Kepler-16 (AB) b",
        "url": "https://ui.adsabs.harvard.edu/abs/2022MNRAS.511.3561T/abstract",
        "description": "Hi"
    },
    {
        "mass": 524.5454,
        "orbital_separation": 0.462,
        "label": "8 Ursae Minoris b",
        "url": "https://ui.adsabs.harvard.edu/abs/2023Natur.618..917H/abstract",
        "description": "Hi"
    },
    {
        "mass": 1,
        "orbital_separation": 1,
        "label": "Earth",
        "url": "https://earth3dmap.com",
        "description": "Home"
    }
];

        var xValues = data.map(d => d.orbital_separation);
        var yValues = data.map(d => d.mass);
        var labels = data.map(d => d.label);
        var urls = data.map(d => d.url);
        var descriptions = data.map(d => d.description || "No description available.");

        var markerSizes = new Array(xValues.length).fill(10);
        var markerColors = new Array(xValues.length).fill("blue");

        var trace = {
            x: xValues,
            y: yValues,
            mode: 'markers',
            type: 'scatter',
            text: labels,
            hoverinfo: 'text',
            marker: {
                size: markerSizes,
                color: markerColors
            }
        };

        var layout = {
            title: {
                text: "Click on a planet",
                font: { family: "Arial, sans-serif", size: 18, color: "#333" }
            },
            xaxis: {
                title: {
                    text: "orbital separation [AU]",
                    font: { family: "Courier New, monospace", size: 16, color: "darkblue" }
                },
                range: [0.01, 3]
            },
            yaxis: {
                title: {
                    text: "log (Planet mass) [log(Earth mass)]",
                    font: { family: "Verdana, sans-serif", size: 16, color: "darkred" }
                },
                type: "log",
                range: [-2, 3]
            },
            dragmode: false
        };

        var config = {
            displayModeBar: false
        };

        Plotly.newPlot('plot', [trace], layout, config);

        document.getElementById('plot').on('plotly_click', function(eventData) {
            var pointIndex = eventData.points[0].pointIndex;
            var x = xValues[pointIndex];
            var y = yValues[pointIndex];
            var label = labels[pointIndex];
            var description = descriptions[pointIndex];
            var url = urls[pointIndex];

            document.getElementById('output').innerHTML =
                `Clicked on: <strong>${label}</strong><br>` +
                `Description: ${description}<br>` +
                `Coordinates: (x=${x}, y=${y})<br>` +
                `URL: <a href="${url}" target="_blank" rel="noopener noreferrer">See ADS entry here</a>`;

            markerSizes.fill(10);
            markerColors.fill("blue");

            markerSizes[pointIndex] = 20;
            markerColors[pointIndex] = "orange";

            Plotly.restyle('plot', {
                'marker.size': [markerSizes],
                'marker.color': [markerColors]
            });

            var qr = new QRious({
                element: document.getElementById('qr-code'),
                value: url,
                size: 150
            });
        });
    </script>

</body>
</html>
